<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>é˜²æŠ–èŠ‚æµçœ‹è¿™ç¯‡å°±å¤Ÿäº† | å­¦ä¹ ç¬”è®°</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/space/assets/css/0.styles.44c8a9cb.css" as="style"><link rel="preload" href="/space/assets/js/app.c334109e.js" as="script"><link rel="preload" href="/space/assets/js/2.733019b2.js" as="script"><link rel="preload" href="/space/assets/js/18.5d362097.js" as="script"><link rel="prefetch" href="/space/assets/js/10.d3dbcd01.js"><link rel="prefetch" href="/space/assets/js/11.419a1f1a.js"><link rel="prefetch" href="/space/assets/js/12.b9c16781.js"><link rel="prefetch" href="/space/assets/js/13.e25e3787.js"><link rel="prefetch" href="/space/assets/js/14.b4f61ea2.js"><link rel="prefetch" href="/space/assets/js/15.bebbaa9f.js"><link rel="prefetch" href="/space/assets/js/16.c43e8ad7.js"><link rel="prefetch" href="/space/assets/js/17.f2e1347b.js"><link rel="prefetch" href="/space/assets/js/19.efd9e707.js"><link rel="prefetch" href="/space/assets/js/20.19342614.js"><link rel="prefetch" href="/space/assets/js/21.c4132e43.js"><link rel="prefetch" href="/space/assets/js/22.c8d95e73.js"><link rel="prefetch" href="/space/assets/js/23.9a276b89.js"><link rel="prefetch" href="/space/assets/js/24.90abfcc9.js"><link rel="prefetch" href="/space/assets/js/25.1da64438.js"><link rel="prefetch" href="/space/assets/js/26.e8493b44.js"><link rel="prefetch" href="/space/assets/js/27.7b13507c.js"><link rel="prefetch" href="/space/assets/js/3.40aa7a3d.js"><link rel="prefetch" href="/space/assets/js/4.da3ef268.js"><link rel="prefetch" href="/space/assets/js/5.dac787d8.js"><link rel="prefetch" href="/space/assets/js/6.820ab661.js"><link rel="prefetch" href="/space/assets/js/7.b04aeb28.js"><link rel="prefetch" href="/space/assets/js/8.8733fc27.js"><link rel="prefetch" href="/space/assets/js/9.76eb16d3.js">
    <link rel="stylesheet" href="/space/assets/css/0.styles.44c8a9cb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/space/" class="home-link router-link-active"><!----> <span class="site-name">å­¦ä¹ ç¬”è®°</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/space/blog/" aria-current="page" class="sidebar-link">ç®€ä»‹</a></li><li><a href="/space/blog/15.html" class="sidebar-link">ğŸµå¥½è®©äººå‚»å‚»åˆ†ä¸æ¸…â€”JSç¯‡</a></li><li><a href="/space/blog/14.html" class="sidebar-link">ğŸ­å¥½è®©äººå‚»å‚»åˆ†ä¸æ¸…â€”DOMç¯‡</a></li><li><a href="/space/blog/13.html" class="sidebar-link">ğŸ¯å¥½è®©äººå‚»å‚»åˆ†ä¸æ¸…â€”CSSç¯‡</a></li><li><a href="/space/blog/12.html" class="sidebar-link">è¿™ä¹ˆå¤šå¹´ä½ è¿˜åœ¨æ€•æ­£åˆ™å—ï¼Ÿ</a></li><li><a href="/space/blog/11.html" class="sidebar-link">æ¥ç”¨Vite+Reactå¿«é€Ÿå¼€å‘æµè§ˆå™¨æ’ä»¶</a></li><li><a href="/space/blog/10.html" class="sidebar-link">ä¼—æ‰€å‘¨çŸ¥çš„æµè§ˆå™¨è°ƒè¯•æ“ä½œ</a></li><li><a href="/space/blog/9.html" class="sidebar-link">ç®€å•çš„å…ƒç´ æ»šåŠ¨ç»„ä»¶</a></li><li><a href="/space/blog/8.html" class="sidebar-link">æ¥ä¸€ä¸ªç®€å•äºŒç»´ç ç”Ÿæˆå™¨</a></li><li><a href="/space/blog/7.html" class="sidebar-link">ç”¨ CSS æ‰¾å›ç«¥å¹´çš„å¿«ä¹ï¼Œå“†å•¦Aæ¢¦ä¼´ä½ åŒè¡Œ</a></li><li><a href="/space/blog/6.html" class="sidebar-link">520ï¼Œ å­¦åºŸ new å¯¹è±¡çš„è¿‡ç¨‹</a></li><li><a href="/space/blog/5.html" class="sidebar-link">è¿™ä¸ª&quot;this&quot;åˆ°åº•æ˜¯ä»€ä¹ˆ</a></li><li><a href="/space/blog/4.html" class="sidebar-link">10 åˆ†é’ŸæŒæ¡æµè§ˆå™¨è¿è¡Œ JS çš„é¡ºåº</a></li><li><a href="/space/blog/3.html" aria-current="page" class="active sidebar-link">é˜²æŠ–èŠ‚æµçœ‹è¿™ç¯‡å°±å¤Ÿäº†</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/space/blog/3.html#å‰è¨€" class="sidebar-link">å‰è¨€</a></li><li class="sidebar-sub-header"><a href="/space/blog/3.html#é˜²æŠ–" class="sidebar-link">é˜²æŠ–</a></li><li class="sidebar-sub-header"><a href="/space/blog/3.html#èŠ‚æµ" class="sidebar-link">èŠ‚æµ</a></li></ul></li><li><a href="/space/blog/2.html" class="sidebar-link">æ˜¯æ—¶å€™ç”¨é—­åŒ…å®ç°ä¸€ä¸ªç¼“å­˜å‡½æ•°äº†</a></li><li><a href="/space/blog/1.html" class="sidebar-link">ä¸å¾—ä¸çŸ¥çš„é—­åŒ…</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="é˜²æŠ–èŠ‚æµçœ‹è¿™ç¯‡å°±å¤Ÿäº†"><a href="#é˜²æŠ–èŠ‚æµçœ‹è¿™ç¯‡å°±å¤Ÿäº†" class="header-anchor">#</a> é˜²æŠ–èŠ‚æµçœ‹è¿™ç¯‡å°±å¤Ÿäº†</h1> <h2 id="å‰è¨€"><a href="#å‰è¨€" class="header-anchor">#</a> å‰è¨€</h2> <p>åœ¨æ—¥å¸¸å¼€å‘ä¸­æˆ‘ä»¬ç»å¸¸é‡åˆ°ä¸€äº›é¢‘ç¹äº‹ä»¶çš„è§¦å‘æƒ…å†µï¼Œæ¯”å¦‚åœ¨æ»šåŠ¨äº‹ä»¶ä¸­éœ€è¦åšä¸ªå¤æ‚è®¡ç®—ã€é˜²æ­¢ä¸€ä¸ªæŒ‰é’®çš„å¤šæ¬¡ç‚¹å‡»æäº¤æ“ä½œã€ç›‘å¬çª—å£çš„ <code>resize</code> äº‹ä»¶å¤„ç†ä¸€äº›é€»è¾‘ç­‰ç­‰ã€‚è¿™äº›éœ€æ±‚éƒ½å¯ä»¥é€šè¿‡å‡½æ•°é˜²æŠ–åŠ¨æˆ–è€…èŠ‚æµæ¥å®ç°ã€‚</p> <p><strong>é˜²æŠ–å’ŒèŠ‚æµçš„ä½œç”¨éƒ½æ˜¯é˜²æ­¢å‡½æ•°å¤šæ¬¡è°ƒç”¨</strong>ã€‚åŒºåˆ«åœ¨äºï¼Œå‡è®¾ä¸€ä¸ªç”¨æˆ·é¢‘ç¹è§¦å‘è¿™ä¸ªå‡½æ•°ï¼Œä¸”æ¯æ¬¡è§¦å‘å‡½æ•°çš„é—´éš”å°äºç­‰å¾…æ—¶é—´ï¼Œé˜²æŠ–çš„æƒ…å†µä¸‹åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œè€ŒèŠ‚æµçš„ä¼šé—´éš”ä¸€å®šæ—¶é—´è§¦å‘å‡½æ•°ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ä¸¤è€…çš„åŒºåˆ«ã€‚</p> <h2 id="é˜²æŠ–"><a href="#é˜²æŠ–" class="header-anchor">#</a> é˜²æŠ–</h2> <blockquote><p>è§¦å‘é«˜é¢‘äº‹ä»¶å n ç§’å†…å‡½æ•°åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœ n ç§’å†…é«˜é¢‘äº‹ä»¶å†æ¬¡è¢«è§¦å‘ï¼Œåˆ™é‡æ–°è®¡ç®—æ—¶é—´</p></blockquote> <p><strong>æ€è·¯ï¼šå¤§éƒ¨åˆ†çš„å®ç°æ–¹å¼æ˜¯æ¯æ¬¡è§¦å‘äº‹ä»¶æ—¶æ¸…é™¤å®šæ—¶å™¨ç„¶åè°ƒç”¨æ–¹æ³•ã€‚è¿™æ¬¡æˆ‘ä»¬æ¢ä¸ªæ€è·¯ä¼˜åŒ–ä¸€ä¸‹ï¼Œæ¯æ¬¡è§¦å‘äº‹ä»¶çš„æ—¶å€™åªæ›´æ–°è§¦å‘æ—¶é—´ï¼Œç„¶åæ¯æ¬¡å°±å¼€å¯ä¸€ä¸ªå®šæ—¶æ¯”å¯¹è§¦å‘æ—¶é—´ã€‚</strong></p> <p>ä¸ºäº†æ›´ç›´è§‚çš„æ„Ÿå—äº‹ä»¶é¢‘ç¹è°ƒç”¨ï¼Œæˆ‘ä»¬æ¥å†™ä¸ªä¾‹å­ï¼š
ä¸‹é¢æ˜¯ä¸ª React ç»„ä»¶ï¼Œæ·»åŠ äº† <code>onMouseMove</code> äº‹ä»¶ç›‘å¬é¼ æ ‡åœç•™çš„åæ ‡ä½ç½®ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/** App.tsx */</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token punctuation">[</span>position<span class="token punctuation">,</span> setPosition<span class="token punctuation">]</span> <span class="token operator">=</span> useState<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
	<span class="token keyword">const</span> <span class="token punctuation">[</span>fontSize<span class="token punctuation">,</span> setFontSize<span class="token punctuation">]</span> <span class="token operator">=</span> useState<span class="token operator">&lt;</span>number<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

	<span class="token keyword">const</span> <span class="token function-variable function">handleMove</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">event</span><span class="token operator">:</span> React<span class="token punctuation">.</span>MouseEvent</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">setPosition</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>event<span class="token punctuation">.</span>pageX<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>event<span class="token punctuation">.</span>pageY<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
            <span class="token comment">// éšæœºè®¾ç½®å½“å‰åæ ‡å­—ä½“å¤§å°</span>
            <span class="token function">setFontSize</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span> styles<span class="token punctuation">.</span>container <span class="token punctuation">}</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span> styles<span class="token punctuation">.</span>content <span class="token punctuation">}</span> onMouseMove<span class="token operator">=</span><span class="token punctuation">{</span>handleMove<span class="token punctuation">}</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> fontSize <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
                  <span class="token punctuation">{</span> position <span class="token punctuation">}</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token punctuation">{</span> styles<span class="token punctuation">.</span>btn <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span> fontSize <span class="token punctuation">}</span><span class="token punctuation">,</span> å¤Ÿå¤§äº†<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
	<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æˆ‘ä»¬æ¥çœ‹çœ‹æ•ˆæœï¼š
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f3d9e0054ec54aa68d4add9a52d39986~tplv-k3u1fbpfcp-zoom-1.image" alt="debounce-1.gif">
æ¥ä¸‹æ¥æˆ‘ä»¬ä¿®æ”¹ <code>handleMove</code> æ·»åŠ é˜²æŠ–é€»è¾‘ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> handleMove <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token function">debounce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">event</span><span class="token operator">:</span> React<span class="token punctuation">.</span>MouseEvent</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setPosition</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>event<span class="token punctuation">.</span>pageX<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>event<span class="token punctuation">.</span>pageY<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token function">setFontSize</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="æ–°æ—§ç‰ˆæ¯”å¯¹"><a href="#æ–°æ—§ç‰ˆæ¯”å¯¹" class="header-anchor">#</a> æ–°æ—§ç‰ˆæ¯”å¯¹</h3> <p>å…ˆæ¥çœ‹ä¸‹æ—§ç‰ˆçš„é˜²æŠ–å®ç°ä»£ç é€»è¾‘ï¼Œæ¯æ¬¡è§¦å‘äº‹ä»¶æ—¶æ¸…é™¤å½“å‰å»¶æ—¶ï¼Œå¼€å¯ä¸‹ä¸€ä¸ªå®šæ—¶ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> waitTime</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> 
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> waitTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠé€»è¾‘ä¼˜åŒ–ä¸€ä¸‹ï¼Œæ¯æ¬¡è§¦å‘äº‹ä»¶çš„æ—¶å€™åªæ›´æ–°è§¦å‘æ—¶é—´ï¼Œå¼€å¯å®šæ—¶ï¼Œåˆ¤æ–­è·ç¦»ä¸Šæ¬¡è§¦å‘æ˜¯å¦å·²ç»è¿‡äº†è®¾ç½®çš„ç­‰å¾…æ—¶é—´ï¼Œå¦‚æœè¿‡äº†ç­‰å¾…æ—¶é—´å°±æ‰§è¡Œ <code>func</code>ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> waitTime</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer<span class="token punctuation">,</span> preTime<span class="token punctuation">,</span> args<span class="token punctuation">,</span> result<span class="token punctuation">;</span>
  <span class="token keyword">let</span> <span class="token function-variable function">now</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  
  <span class="token keyword">let</span> <span class="token function-variable function">later</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> passedTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> preTime<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>waitTime <span class="token operator">&gt;</span> passedTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>later<span class="token punctuation">,</span> waitTime <span class="token operator">-</span> passedTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token comment">// func å¯èƒ½ä¼šæœ‰è¿”å›å€¼</span>
      result <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// è¿™ä¸ªæ£€æŸ¥æ˜¯å¿…éœ€çš„ï¼Œå› ä¸º func å¯èƒ½é€’å½’è°ƒç”¨ debounce</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        args <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> <span class="token function-variable function">debounced</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>_args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      args <span class="token operator">=</span> _args
      preTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>later<span class="token punctuation">,</span> waitTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> debounced<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä»¥ä¸Šä¸¤ç§æ–¹å¼å®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼š
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/08bec2a01d8d4f07b239033938849074~tplv-k3u1fbpfcp-zoom-1.image" alt="debounce-2.gif"></p> <h3 id="ç«‹å³æ‰§è¡Œ"><a href="#ç«‹å³æ‰§è¡Œ" class="header-anchor">#</a> ç«‹å³æ‰§è¡Œ</h3> <p>ä»¥ä¸Šä¸¤ä¸ªå‡½æ•°è§¦å‘çš„æ—¶æœºéƒ½æ˜¯åœ¨åœæ­¢è§¦å‘å n ç§’æ‰æ‰§è¡Œ <code>func</code> ï¼Œå¦‚æœæƒ³è¦åè¿‡æ¥ï¼Œå…ˆç«‹åˆ»æ‰§è¡Œå‡½æ•°ï¼Œç„¶åç­‰åˆ°åœæ­¢è§¦å‘ n ç§’åï¼Œæ‰å¯ä»¥é‡æ–°è§¦å‘æ‰§è¡Œé‚£è¦æ€ä¹ˆåšï¼Ÿ</p> <p>æ¥ä¸‹æ¥æˆ‘ä»¬æŒ‰ç…§ä¸Šé¢çš„éœ€æ±‚ä¿®æ”¹ä¸‹ <code>debounce</code> å‡½æ•°ï¼Œæ·»åŠ ä¸€ä¸ª <code>immediate</code> å‚æ•°æ§åˆ¶æ˜¯å¦å…ˆç«‹å³æ‰§è¡Œï¼Œä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> waitTime<span class="token punctuation">,</span> immediate <span class="token operator">=</span> <span class="token boolean">false</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer<span class="token punctuation">,</span> preTime<span class="token punctuation">,</span> args<span class="token punctuation">,</span> result<span class="token punctuation">;</span>
  <span class="token keyword">let</span> <span class="token function-variable function">now</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  
  <span class="token keyword">let</span> <span class="token function-variable function">later</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> passedTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> preTime<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>waitTime <span class="token operator">&gt;</span> passedTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>later<span class="token punctuation">,</span> waitTime <span class="token operator">-</span> passedTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>immediate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// è¿™ä¸ªæ£€æŸ¥æ˜¯å¿…éœ€çš„ï¼Œå› ä¸º func å¯èƒ½é€’å½’è°ƒç”¨ debounce</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        args <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> <span class="token function-variable function">debounced</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>_args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      args <span class="token operator">=</span> _args
      preTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>later<span class="token punctuation">,</span> waitTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>immediate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> debounced<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™é‡Œè®¾ç½®äº† <code>immediate: true</code> æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d1a2de75d2554e86ae75d58a7d317114~tplv-k3u1fbpfcp-zoom-1.image" alt="debounce-3.gif"></p> <h3 id="å–æ¶ˆé˜²æŠ–"><a href="#å–æ¶ˆé˜²æŠ–" class="header-anchor">#</a> å–æ¶ˆé˜²æŠ–</h3> <p>ç°åœ¨åˆæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚ <code>debounce</code> çš„é—´éš”æ—¶é—´æ˜¯ 10 ç§’ï¼Œ<code>immediate</code> ä¸º <code>true</code>ï¼Œè¿™æ ·çš„è¯ï¼Œåªæœ‰ç­‰ 10 ç§’åæ‰èƒ½é‡æ–°è§¦å‘ä¸‹ä¸€ä¸ªäº‹ä»¶ã€‚å¦‚æœèƒ½æœ‰ä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»åï¼Œå–æ¶ˆé˜²æŠ–ï¼Œè¿™æ ·å†å»è§¦å‘ <code>debounce</code>ï¼Œæ˜¯ä¸æ˜¯å°±åˆå¯ä»¥ç«‹åˆ»æ‰§è¡Œäº‹ä»¶äº†ï¼ŸæŒ‰ç…§ä¸Šé¢çš„æ€è·¯ï¼Œæˆ‘ä»¬ç»™ <code>debounce</code> æ·»åŠ ä¸€ä¸ªå–æ¶ˆé€»è¾‘å§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> waitTime<span class="token punctuation">,</span> immediate <span class="token operator">=</span> <span class="token boolean">false</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  
  <span class="token operator">...</span>
  
  debounced<span class="token punctuation">.</span><span class="token function-variable function">cancel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    timer <span class="token operator">=</span> args <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> debounced<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a6c53269c00a40a2b693c6991aed73a6~tplv-k3u1fbpfcp-zoom-1.image" alt="debounce-4.gif"></p> <h2 id="èŠ‚æµ"><a href="#èŠ‚æµ" class="header-anchor">#</a> èŠ‚æµ</h2> <blockquote><p>é«˜é¢‘äº‹ä»¶è§¦å‘ï¼Œä½†åœ¨ n ç§’å†…åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥èŠ‚æµä¼šç¨€é‡Šå‡½æ•°çš„æ‰§è¡Œé¢‘ç‡</p></blockquote> <p><strong>æ€è·¯ï¼šèŠ‚æµçš„å®ç°ï¼Œæœ‰ä¸¤ç§ä¸»æµçš„å®ç°æ–¹å¼</strong></p> <ol><li><strong>æ ‡è®°è§¦å‘æ—¶é—´ï¼Œæ¯æ¬¡è§¦å‘äº‹ä»¶æ—¶æ¯”å¯¹å½“å‰æ—¶é—´</strong></li> <li><strong>è®¾ç½®å®šæ—¶å™¨ï¼šæ¯æ¬¡è§¦å‘äº‹ä»¶æ—¶éƒ½åˆ¤æ–­å½“å‰æ˜¯å¦æœ‰ç­‰å¾…çš„å®šæ—¶å™¨</strong></li></ol> <p>å¦å¤–ä»¥ä¸Šä¸¤ç§æ–¹å¼æ•ˆæœä¸Šä¼šæœ‰æ‰€ä¸åŒï¼Œæ•ˆæœåˆ†åˆ«æ˜¯é¦–æ¬¡æ‰§è¡Œä»¥åŠç»“æŸåæ‰§è¡Œï¼Œå®ç°çš„æ–¹å¼ä¹Ÿæœ‰æ‰€ä¸åŒã€‚æˆ‘ä»¬é€šè¿‡å‚æ•° <code>leading</code> è¡¨ç¤ºé¦–æ¬¡æ˜¯å¦æ‰§è¡Œï¼Œ<code>trailing</code> è¡¨ç¤ºç»“æŸåæ˜¯å¦å†æ‰§è¡Œä¸€æ¬¡ã€‚</p> <h3 id="æ ‡è®°è§¦å‘æ—¶é—´"><a href="#æ ‡è®°è§¦å‘æ—¶é—´" class="header-anchor">#</a> æ ‡è®°è§¦å‘æ—¶é—´</h3> <p>å½“è§¦å‘äº‹ä»¶çš„æ—¶å€™ï¼Œè®¡ç®—è·ç¦»ä¸Šæ¬¡è§¦å‘æ—¶é—´ï¼ˆå½“å‰æ—¶é—´æˆ³ - ä¸Šæ¬¡æ ‡è®°çš„æ—¶é—´æˆ³: åˆå§‹å€¼ä¸º 0ï¼Œå¦‚æœå¤§äºè®¾ç½®çš„æ—¶é—´é—´éš”ï¼Œå°±æ‰§è¡Œå‡½æ•°ï¼Œå¹¶æ›´æ–°è§¦å‘æ—¶é—´ï¼Œå¦åˆ™ï¼Œä¸æ‰§è¡Œã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> waitTime</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> preTime <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">const</span> <span class="token function-variable function">now</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> preTime <span class="token operator">&gt;</span> waitTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            preTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/615c542730a548e486bd58add1430c0b~tplv-k3u1fbpfcp-zoom-1.image" alt="throttle-1.gif"></p> <h3 id="è®¾ç½®å®šæ—¶å™¨"><a href="#è®¾ç½®å®šæ—¶å™¨" class="header-anchor">#</a> è®¾ç½®å®šæ—¶å™¨</h3> <p>å½“è§¦å‘äº‹ä»¶çš„æ—¶å€™ï¼Œè®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå†è§¦å‘äº‹ä»¶çš„æ—¶å€™ï¼Œåˆ¤æ–­å®šæ—¶å™¨æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨å°±ä¸æ‰§è¡Œï¼Œç›´åˆ°è§¦å‘å®šæ—¶å™¨ï¼Œæ‰§è¡Œå‡½æ•° <code>func</code>ï¼Œæ¸…ç©ºå®šæ—¶å™¨ï¼Œè¿™æ ·ä¸‹æ¬¡è§¦å‘äº‹ä»¶å°±ä¼šå¼€å¯ä¸€ä¸ªæ–°çš„å®šæ—¶å™¨ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> waitTime</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> timer
    
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> waitTime<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/16e0be84d13f4ccf8481b759b2106f09~tplv-k3u1fbpfcp-zoom-1.image" alt="throttle-2.gif">
ä»ä¸Šé¢çš„æœ€ç»ˆæ•ˆæœå¯ä»¥çœ‹å‡ºä¸¤ç§æ–¹å¼çš„åŒºåˆ«ï¼š</p> <ol><li>ç¬¬ä¸€ç§äº‹ä»¶ä¼šç«‹åˆ»æ‰§è¡Œï¼Œç¬¬äºŒç§äº‹ä»¶ä¼šåœ¨ n ç§’åç¬¬ä¸€æ¬¡æ‰§è¡Œ</li> <li>ç¬¬ä¸€ç§äº‹ä»¶åœæ­¢è§¦å‘åæ²¡æœ‰åŠæ³•å†æ‰§è¡Œäº‹ä»¶ï¼Œç¬¬äºŒç§äº‹ä»¶åœæ­¢è§¦å‘åè¿˜ä¼šå†æ‰§è¡Œä¸€æ¬¡äº‹ä»¶</li></ol> <h3 id="åˆäºŒä¸ºä¸€"><a href="#åˆäºŒä¸ºä¸€" class="header-anchor">#</a> åˆäºŒä¸ºä¸€</h3> <p>å¦‚æœç»“åˆä»¥ä¸Šä¸¤ç§æ–¹å¼çš„é€»è¾‘ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°ä¸€ä¸ªèƒ½ç«‹åˆ»æ‰§è¡Œï¼Œåœæ­¢è§¦å‘åè¿˜èƒ½åœ¨æœ€åå†æ‰§è¡Œä¸€æ¬¡ï¼Œä¸”çœ‹ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> waitTime</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> timer<span class="token punctuation">,</span> args<span class="token punctuation">,</span> result<span class="token punctuation">;</span>
    <span class="token keyword">let</span> preTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">now</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> <span class="token function-variable function">later</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        preTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            args <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token function-variable function">throttled</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>_args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> passedTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> preTime<span class="token punctuation">;</span>
        args <span class="token operator">=</span> _args<span class="token punctuation">;</span>
        <span class="token comment">// ä¿®æ”¹è¿‡ç³»ç»Ÿæœ¬åœ°æ—¶é—´ï¼ŒpassedTime ä¼šå°äº 0</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>passedTime <span class="token operator">&gt;</span> waitTime <span class="token operator">||</span> passedTime <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            preTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            result <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                args <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>later<span class="token punctuation">,</span> waitTime <span class="token operator">-</span> passedTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> throttled<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fa63148cfe0744989b3727d5f2684197~tplv-k3u1fbpfcp-zoom-1.image" alt="throttle-3.gif"></p> <h3 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="header-anchor">#</a> ä¼˜åŒ–</h3> <p>æˆ‘ä»¬è¿˜å¯ä»¥ç»™ <code>throttle</code> æ·»åŠ ä¸€ä¸ª <code>options</code> æ¥æ§åˆ¶æ˜¯<strong>æ ‡è®°è§¦å‘æ—¶é—´</strong>è¿˜æ˜¯<strong>è®¾ç½®å®šæ—¶å™¨</strong>çš„æ–¹å¼ï¼Œæˆ‘ä»¬çº¦å®š:
<code>leadingï¼šfalse</code> è¡¨ç¤º<strong>æ ‡è®°è§¦å‘æ—¶é—´æ–¹å¼</strong>ï¼Œ<code>trailing: false</code> è¡¨ç¤ºç¦ç”¨<strong>è®¾ç½®å®šæ—¶å™¨æ–¹å¼ï¼Œä¸”ä¸¤è€…ä¸åº”è¯¥åŒæ—¶ç¦ç”¨</strong>ã€‚ä»£ç é€»è¾‘å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> waitTime<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> timer<span class="token punctuation">,</span> args<span class="token punctuation">,</span> result<span class="token punctuation">;</span>
    <span class="token keyword">let</span> preTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">now</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  
    <span class="token keyword">let</span> <span class="token function-variable function">later</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      preTime <span class="token operator">=</span> options<span class="token punctuation">.</span>leading <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      result <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        args <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  
    <span class="token keyword">let</span> <span class="token function-variable function">throttled</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>_args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>preTime <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>leading <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          preTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> passedTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> preTime<span class="token punctuation">;</span>
      args <span class="token operator">=</span> _args<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>passedTime <span class="token operator">&gt;</span> waitTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        preTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          args <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>trailing <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>later<span class="token punctuation">,</span> waitTime <span class="token operator">-</span> passedTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  
    <span class="token keyword">return</span> throttled<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>è¿™é‡Œè®¾ç½®äº† <code>leadingï¼šfalse</code> æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/50713cb837a4483681e4bbf2d32dd672~tplv-k3u1fbpfcp-zoom-1.image" alt="throttle-4.gif"></p> <h3 id="å–æ¶ˆèŠ‚æµ"><a href="#å–æ¶ˆèŠ‚æµ" class="header-anchor">#</a> å–æ¶ˆèŠ‚æµ</h3> <p>åŒæ ·çš„ï¼Œåœ¨ <code>throttle</code> æˆ‘ä»¬ä¹ŸåŠ ä¸ª <code>cancel</code> æ–¹æ³•å§</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> waitTime<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  
  <span class="token operator">...</span>
  
  throttled<span class="token punctuation">.</span><span class="token function-variable function">cancel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    preTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> throttled<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/space/blog/4.html" class="prev">
        10 åˆ†é’ŸæŒæ¡æµè§ˆå™¨è¿è¡Œ JS çš„é¡ºåº
      </a></span> <span class="next"><a href="/space/blog/2.html">
        æ˜¯æ—¶å€™ç”¨é—­åŒ…å®ç°ä¸€ä¸ªç¼“å­˜å‡½æ•°äº†
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/space/assets/js/app.c334109e.js" defer></script><script src="/space/assets/js/2.733019b2.js" defer></script><script src="/space/assets/js/18.5d362097.js" defer></script>
  </body>
</html>
